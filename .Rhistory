install.packages("alabama")
install.packages("PracTools")
5862+2974+1619+561+467+196+163
4806+2394+1267+450+404+161+131
2617*.684
2617-1790
48.5+5.4
34.7+1.8
31169+5195+3306+3967+11563+22105+10316+15474
11132+1855+1181+1416+4216+7895+3684+5526
14000+7000+14000+13999
3684+1842+3684+3683
600*.6
1200/21
library(knitr)
Sweave2knitr("Ex1.Rnw")
Sweave2knitr("H:/Sand_Summerschool/SamplingAndEsimation/tutorial/Exercises/Exercise1/x1.Rnw")
Sweave2knitr("H:/Sand_Summerschool/SamplingAndEsimation/tutorial/Exercises/Exercise1/Ex1.Rnw")
library(survey)
data(api)
View(apisrs)
library(foreign)
library(survey)
path <- "F:/ESS Data/"
path.ger <- "F:/ESS Data/Germany/"
path.net <- "F:/ESS Data/Netherlands/"
setwd(path)
#### Germany ####
Ger.d <- read.spss(paste(path.ger,"ESS5DE.spss/ESS5DE.sav",sep=""),to.data.frame = TRUE)
Ger.ctry <- read.spss(paste(path.ger,"ESS5_DE_SDDF.spss/ESS5_DE_SDDF.por",sep=""),to.data.frame = TRUE, use.value.labels = TRUE)
colnames(Ger.d)[5] <- "IDNO"
Ger <- merge(Ger.d,Ger.ctry,by="IDNO", all.x = TRUE)
Ger$PSU <- as.factor(Ger$PSU)
n <- nrow(Ger)
L <- length(unique(Ger$PSU))
## deffp
df.tab <- as.data.frame(table(Ger$PSU,Ger$dweight))
head(deff.tab)
deff.tab <- subset(df.tab,df.tab[,3]!=0)
deff.tab[,2] <- as.numeric(as.character(deff.tab[,2]))
deff_p <- n*sum(deff.tab[,3]*deff.tab[,2]^2)/(sum(deff.tab[,3]*deff.tab[,2])^2)
## deffc
b <- sum(tapply(Ger$dweight,Ger$PSU,function(x)sum(x)^2))/sum(Ger$dweight^2)
SS <- anova(lm(as.numeric(Ger$agea)~Ger$PSU))
MSB <- SS$`Mean Sq`[1]
MSW <- SS$`Mean Sq`[2]
K <- 1/(L-1)*(n-sum(deff.tab[,3]^2/n))
rho <- (MSB-MSW)/(MSB+(K-1)*MSW)
deff_c <- 1+(b-1)*rho
## deff
deff <- deff_p*deff_c
deff
View(SS)
neff <- nrow(Ger)/deff
neff
library("knitr", lib.loc="~/R/win-library/3.1")
Sweave2knitr(Day1.Rnw)
Sweave2knitr("H:/Sand_Summerschool/SamplingAndEsimation/tutorial/slides/Part1/Day1.Rnw")
